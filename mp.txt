Aim: - MapReduce
pip install mrjob
%%writefile wordcount.py
from mrjob.job import MRJob
import re

WORD_REGEXP = re.compile(r"[a-zA-Z]+")

class MRWordCount(MRJob):

    def mapper(self, _, line):
        for word in WORD_REGEXP.findall(line):
            yield word.lower(), 1

    def reducer(self, word, counts):
        yield word, sum(counts)

if __name__ == "__main__":
    MRWordCount.run()
%%writefile example.txt
Hello world
Hello Google Colab
MapReduce word count example
Hello MapReduce
!python wordcount.py example.txt

Aim : - Multi,Sort,Index
from collections import defaultdict
A=[
    [1,2,3],
    [4,5,6]
    ]
B=[[7,8],
   [9,10],
   [11,12]
   ]
m,n=len(A),len(A[0])
n2,p=len(B),len(B[0])

assert n==n2,"Matrix Multiplication not possible"

mapped = []

for i in range(m):
    for j in range(n):
        for k in range(p):
            mapped.append(((i, k), ('A', j, A[i][j])))

for j in range(n):
    for k in range(p):
        for i in range(m):
            mapped.append(((i, k), ('B', j, B[j][k])))

shuffle = defaultdict(list)
for key, value in mapped:
    shuffle[key].append(value)

result = {}

for key in shuffle:
    values = shuffle[key]
    A_vals = {}
    B_vals = {}

    for tag, j, val in values:
        if tag == 'A':
            A_vals[j] = val
        else:
            B_vals[j] = val

    total = 0
    for j in A_vals:
        if j in B_vals:
            total += A_vals[j] * B_vals[j]

    result[key] = total
    result_matrix=[[0 for _ in range(p)] for _ in range(m)]
    for (i, k), val in result.items():
        result_matrix[i][k] = val
        
print("Result Matrix:")
for row in result_matrix:
    print(row)

from collections import defaultdict

data = [5, 1, 9, 3, 7, 2, 8]

mapped = []
for num in data:
    mapped.append((num, num))

shuffle = defaultdict(list)
for key, value in mapped:
    shuffle[key].append(value)

sorted_result = []
for key in sorted(shuffle.keys()):
    sorted_result.extend(shuffle[key])

print("Sorted Output:")
print(sorted_result)

from collections import defaultdict

documents = {
    "doc1": "big data analytics",
    "doc2": "data mining and big data",
    "doc3": "analytics and mining"
}

mapped = []

for doc_id, text in documents.items():
    words = text.split()
    for word in words:
        mapped.append((word.lower(), doc_id))

shuffle = defaultdict(list)
for word, doc_id in mapped:
    shuffle[word].append(doc_id)

inverted_index = {}

for word, doc_ids in shuffle.items():
    inverted_index[word] = list(set(doc_ids))

print("Inverted Index:")
for word, docs in inverted_index.items():
    print(f"{word} -> {docs}")

